(window.webpackJsonp=window.webpackJsonp||[]).push([[13],{syWp:function(e,t,n){"use strict";n.r(t);var a=n("o0o1"),r=n.n(a),i=(n("ls82"),n("HaE+")),o=n("dI71"),l=n("q1tI"),s=n.n(l),u=n("vOnD"),c=n("eHHv"),p=n("ZCxb"),d=n.n(p),f=n("QojX"),m=n("cWnB"),h=n("yTmA"),y=n("PjpU"),b=n("kT3S"),g=n("F7AD"),v=n("EYWl"),E=n("lEpx"),w=Object(u.default)(f.a).withConfig({displayName:"apply__CenteredForm",componentId:"sc-19k1uo4-0"})(["display:flex;flex-direction:column;align-items:center;max-width:500px;flex:auto;margin-bottom:25px;"]),x=function(e){0===e.files.length?(e.setCustomValidity("You must upload a file!"),d()("Uh oh!","You must upload a file!","error")):e.files.length>1?(e.setCustomValidity("You can only upload 1 file!"),d()("Uh oh!","You can only upload 1 file!","error")):e.files[0].size>1048576?(e.setCustomValidity("Max file size is 1MB!"),e.value="",d()("Uh oh!","Max file size is 1MB!","error")):e.setCustomValidity("")},k=function(e){function t(){for(var t,n=arguments.length,a=new Array(n),o=0;o<n;o++)a[o]=arguments[o];return(t=e.call.apply(e,[this].concat(a))||this)._initFirebase=!1,t.state={applicationFormConfig:null,initialApplicationData:null,generalSettings:null,loading:!0,validated:!1,sending:!1,submitted:!1,alreadyApplied:!1,errorMsg:""},t.loadData=Object(i.a)(r.a.mark((function e(){var n,a,i,o;return r.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t._initFirebase=!0,n=t.props.firebase.applicationFormConfig().get().then((function(e){return e.data()})).catch((function(){return t.setState({errorMsg:"Application Form Config doesn't exist!",loading:!1})})),a=t.props.firebase.user(t.context.uid).get().then((function(e){return e.data()})).catch(console.error),i=t.props.firebase.generalSettings().get().then((function(e){return e.data()})).catch((function(){return t.setState({errorMsg:"General settings doesn't exist!",loading:!1})})),o=t.props.firebase.application(t.context.uid).get().then((function(e){return e.exists?e.data():null})).catch(console.error),Promise.all([n,a,i,o]).then((function(e){return t.setState({loading:!1,applicationFormConfig:e[0],alreadyApplied:e[1].roles.hasOwnProperty("applicant"),generalSettings:e[2],initialApplicationData:e[3]})}));case 6:case"end":return e.stop()}}),e)}))),t}Object(o.a)(t,e);var a=t.prototype;return a.componentDidMount=function(){this.props.firebase&&!this._initFirebase&&this.loadData()},a.componentDidUpdate=function(e){this.props.firebase&&!this._initFirebase&&this.loadData(),"undefined"!=typeof window&&n.e(6).then(n.t.bind(null,"5buq",7)).then((function(e){e.init()}))},a.render=function(){var e=this,t=this.state,n=t.loading,a=t.errorMsg,o=t.submitted,l=t.validated,u=t.applicationFormConfig,c=t.sending,p=t.alreadyApplied,h=t.generalSettings;if(n)return s.a.createElement(b.a,null);if(!h.applicationsOpen)return s.a.createElement(E.c,{flexdirection:"column",style:{justifyContent:"center",alignItems:"center",maxWidth:700}},s.a.createElement(g.a,{size:"medium"}),s.a.createElement("h1",null,"Applications are closed!"),s.a.createElement("p",null,"Unfortunately, the application for the"," ",u.semester," season has closed. If you're interesting in joining BU UPE, please come back next semester and apply, we'd love to have you! In the meantime, feel free to check out the public events on"," ",s.a.createElement("a",{href:"https://upe.bu.edu/events"},"our calendar"),"."));var y=function(){var t=Object(i.a)(r.a.mark((function t(n){var a,i,o,l,s,u,c,p,f,m,y,b,g,v,E,w,k,A,C;return r.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(n.preventDefault(),h.applicationsOpen){t.next=4;break}return d()("Uh oh!","Applications are closed! Not sure how you got here, but unfortunately we can't submit this for you as applications have closed.","error"),t.abrupt("return");case 4:if(a=n.currentTarget,(i=Array.from(a.querySelectorAll(".custom-file-input"))).forEach((function(e){return x(e)})),!1!==a.checkValidity()){t.next=11;break}n.stopPropagation(),t.next=30;break;case 11:return e.setState({sending:!0}),o=Array.from(a.querySelectorAll(".form-control")),l=Array.from(a.querySelectorAll(".custom-radio>.custom-control-input")).filter((function(e){return e.checked})),s=e.state.applicationFormConfig,u=s.semester,c=s.questions,p=e.context,f=p.uid,(m=p.roles).applicant=!0,g=o.map((function(e){var t=e.id,n=e.value,a=parseInt(t);1===a?y=n.split(" ")[0]:2===a&&(b=n);var r=c.find((function(e){return e.id===a})),i=r.name,o=r.order,l=r.type;return{id:a,value:n,name:i,order:o,type:l}})),v=l.map((function(e){var t=e.name,n=e.value,a=parseInt(t),r="true"==n,i=c.find((function(e){return e.id===a})),o=i.name,l=i.order,s=i.type;return{id:a,value:r,name:o,order:l,type:s}})),E=i.map((function(t){return new Promise((function(n,a){var r=parseInt(t.id.split("-").pop());e.props.firebase.file(f,r).put(t.files[0]).then((function(e){return e.ref.getDownloadURL()})).then((function(e){var t=c.find((function(e){return e.id===r})),a=t.name,i=t.order,o=t.type;return n({id:r,value:e,name:a,order:i,type:o})}))}))})),t.next=22,Promise.all(E);case 22:return w=t.sent,g=g.concat(w).concat(v),k=e.props.firebase.application(f).set({responses:g,semester:u,deliberation:{accepted:!1,confirmed:!1,feedback:"",votes:{}},interview:{interviewed:!1}}),A=e.props.firebase.user(f).update({roles:m}),C=e.props.firebase.sendApplicationReceipt({email:b,firstName:y}),t.next=29,Promise.all([k,A,C]);case 29:e.setState({submitted:!0,sending:!1});case 30:e.setState({validated:!0});case 31:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}(),k=s.a.createElement(E.c,{flexdirection:"column"},s.a.createElement("div",{style:{alignSelf:"center"}},s.a.createElement(g.a,{size:"medium"})),s.a.createElement("h1",null,"Application Submitted!"),s.a.createElement("p",null,"Thank you for applying to join BU UPE. Please check your email for a confirmation of your submission. Further details, such as interview timeslots, will be prompted via email and can be entered in this application. If you'd like to edit your submission, simply refresh this page and re-apply."));if(a)return s.a.createElement(E.c,{flexdirection:"column"},s.a.createElement("h1",null,"Uh oh!"),s.a.createElement("p",null,a));if(o)return k;return s.a.createElement(s.a.Fragment,null,s.a.createElement(v.a,{title:"Apply",route:"/apply"}),s.a.createElement(E.c,{flexdirection:"row",style:{justifyContent:"center"}},s.a.createElement(w,{noValidate:!0,validated:l,onSubmit:y},s.a.createElement(g.a,{size:"medium"}),s.a.createElement("h1",null,"Apply to BU UPE"),p&&s.a.createElement("p",{style:{color:"red"}},"Look's like you've already applied! Feel free to reapply however, just note that it will overwrite your previous submission."),u.questions.sort((function(e,t){return e.order>t.order?1:-1})).map((function(t){return function(t){var n,a=e.state.initialApplicationData,r="";switch(null!==a?r=a.responses.find((function(e){return e.id===t.id})).value:1===t.id?r=e.context.name:2===t.id&&(r=e.context.email),t.type){case"textarea":n=s.a.createElement(f.a.Control,{required:t.required,as:"textarea",rows:"3",defaultValue:r});break;case"file":n=s.a.createElement(f.a.File,{id:"custom-file-"+t.id,label:"Upload file",custom:!0,accept:".pdf",onChange:function(e){return x(e.target)}});break;case"yesno":n=s.a.createElement("div",null,s.a.createElement(f.a.Check,{custom:!0,required:t.required,inline:!0,defaultChecked:r,value:"true",label:"Yes",type:"radio",name:t.id,id:t.id+"-1"}),s.a.createElement(f.a.Check,{custom:!0,required:t.required,inline:!0,defaultChecked:!r,value:"false",label:"No",type:"radio",name:t.id,id:t.id+"-2"}));break;default:n=s.a.createElement(f.a.Control,{required:t.required,type:t.type,defaultValue:r})}return s.a.createElement(f.a.Row,{style:{width:"100%"},key:t.id},s.a.createElement(f.a.Group,{controlId:t.id,style:{width:"100%"}},s.a.createElement(f.a.Label,null,t.name," ",t.required&&s.a.createElement(E.h,null)),n))}(t)})),s.a.createElement(m.a,{type:"submit",disabled:c},c?"Submitting...":"Submit"))))},t}(l.Component);k.contextType=h.AuthUserContext,t.default=Object(c.a)(Object(h.withAuthorization)(y.d),h.withFirebase)(k)}}]);
//# sourceMappingURL=component---src-pages-apply-js-5e8dcf067a8e49648c3d.js.map