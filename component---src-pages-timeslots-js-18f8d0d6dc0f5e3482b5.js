(window.webpackJsonp=window.webpackJsonp||[]).push([[16],{"3Z9Z":function(e,t,n){"use strict";var r=n("wx14"),a=n("zLVn"),i=n("TSYQ"),o=n.n(i),s=n("q1tI"),l=n.n(s),c=n("vUet"),u=["xl","lg","md","sm","xs"],f=l.a.forwardRef((function(e,t){var n=e.bsPrefix,i=e.className,s=e.noGutters,f=e.as,d=void 0===f?"div":f,m=Object(a.a)(e,["bsPrefix","className","noGutters","as"]),h=Object(c.a)(n,"row"),p=h+"-cols",v=[];return u.forEach((function(e){var t,n=m[e];delete m[e];var r="xs"!==e?"-"+e:"";null!=(t=null!=n&&"object"==typeof n?n.cols:n)&&v.push(""+p+r+"-"+t)})),l.a.createElement(d,Object(r.a)({ref:t},m,{className:o.a.apply(void 0,[i,h,s&&"no-gutters"].concat(v))}))}));f.displayName="Row",f.defaultProps={noGutters:!1},t.a=f},"7xGa":function(e,t,n){"use strict";var r,a=n("wx14"),i=n("zLVn"),o=n("TSYQ"),s=n.n(o),l=n("YECM"),c=n("q1tI"),u=n.n(c),f=n("dRu9"),d=n("z+q/"),m=((r={})[f.b]="show",r[f.a]="show",r),h=u.a.forwardRef((function(e,t){var n=e.className,r=e.children,o=Object(i.a)(e,["className","children"]),h=Object(c.useCallback)((function(e){Object(d.a)(e),o.onEnter&&o.onEnter(e)}),[o]);return u.a.createElement(f.e,Object(a.a)({ref:t,addEndListener:l.a},o,{onEnter:h}),(function(e,t){return u.a.cloneElement(r,Object(a.a)({},t,{className:s()("fade",n,r.props.className,m[e])}))}))}));h.defaultProps={in:!1,timeout:300,mountOnEnter:!1,unmountOnExit:!1,appear:!1},h.displayName="Fade",t.a=h},BIHw:function(e,t,n){"use strict";var r=n("I+eb"),a=n("or9q"),i=n("ewvW"),o=n("UMSQ"),s=n("ppGB"),l=n("ZfDv");r({target:"Array",proto:!0},{flat:function(){var e=arguments.length?arguments[0]:void 0,t=i(this),n=o(t.length),r=l(t,0);return r.length=a(r,t,t,n,0,void 0===e?1:s(e)),r}})},JeC3:function(e,t,n){"use strict";var r=n("wx14"),a=n("zLVn"),i=n("q1tI"),o=n.n(i),s=n("TSYQ"),l=n.n(s),c=n("XcHJ"),u=n("i52p"),f=Math.pow(2,31)-1;function d(){var e=Object(c.a)(),t=Object(i.useRef)();return Object(u.a)((function(){return clearTimeout(t.current)})),Object(i.useMemo)((function(){var n=function(){return clearTimeout(t.current)};return{set:function(r,a){void 0===a&&(a=0),e()&&(n(),a<=f?t.current=setTimeout(r,a):function e(t,n,r){var a=r-Date.now();t.current=a<=f?setTimeout(n,a):setTimeout((function(){return e(t,n,r)}),f)}(t,r,Date.now()+a))},clear:n}}),[])}var m=n("7xGa"),h=n("ZCiN"),p=n("vUet"),v=n("XQC9"),b=o.a.createContext({onClose:function(){}}),g=o.a.forwardRef((function(e,t){var n=e.bsPrefix,s=e.closeLabel,c=e.closeButton,u=e.className,f=e.children,d=Object(a.a)(e,["bsPrefix","closeLabel","closeButton","className","children"]);n=Object(p.a)(n,"toast-header");var m=Object(i.useContext)(b),g=Object(h.a)((function(e){m&&m.onClose&&m.onClose(e)}));return o.a.createElement("div",Object(r.a)({ref:t},d,{className:l()(n,u)}),f,c&&o.a.createElement(v.a,{label:s,onClick:g,className:"ml-2 mb-1","data-dismiss":"toast"}))}));g.displayName="ToastHeader",g.defaultProps={closeLabel:"Close",closeButton:!0};var w=g,y=n("YdCC"),O=Object(y.a)("toast-body"),E=o.a.forwardRef((function(e,t){var n=e.bsPrefix,s=e.className,c=e.children,u=e.transition,f=void 0===u?m.a:u,h=e.show,v=void 0===h||h,g=e.animation,w=void 0===g||g,y=e.delay,O=void 0===y?3e3:y,E=e.autohide,j=void 0!==E&&E,T=e.onClose,S=Object(a.a)(e,["bsPrefix","className","children","transition","show","animation","delay","autohide","onClose"]);n=Object(p.a)(n,"toast");var x=Object(i.useRef)(O),C=Object(i.useRef)(T);Object(i.useEffect)((function(){x.current=O,C.current=T}),[O,T]);var D=d(),M=!(!j||!v),k=Object(i.useCallback)((function(){M&&(null==C.current||C.current())}),[M]);Object(i.useEffect)((function(){D.set(k,x.current)}),[D,k]);var L=Object(i.useMemo)((function(){return{onClose:T}}),[T]),P=!(!f||!w),N=o.a.createElement("div",Object(r.a)({},S,{ref:t,className:l()(n,s,!P&&(v?"show":"hide")),role:"alert","aria-live":"assertive","aria-atomic":"true"}),c);return o.a.createElement(b.Provider,{value:L},P&&f?o.a.createElement(f,{in:v,unmountOnExit:!0},N):N)}));E.displayName="Toast";t.a=Object.assign(E,{Body:O,Header:w})},QGkA:function(e,t,n){n("RNIs")("flat")},XIxq:function(e,t,n){"use strict";n.r(t);var r=n("q1tI"),a=n.n(r),i=n("PjpU"),o=n("yTmA"),s=n("7oih"),l=(n("BIHw"),n("QGkA"),n("HaE+")),c=n("dI71"),u=n("eHHv"),f=n("ZCxb"),d=n.n(f),m=n("cWnB"),h=n("JeC3"),p=n("kT3S"),v=n("lEpx"),b=n("3Z9Z"),g=function(e){function t(){for(var t,n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return(t=e.call.apply(e,[this].concat(r))||this).slider=a.a.createRef(),t.isDown=!1,t.startX=null,t.scrollLeft=null,t.handleMouseDown=function(e){t.isDown=!0,t.startX=e.pageX-t.slider.current.offsetLeft,t.scrollLeft=t.slider.current.scrollLeft},t.handleMouseUp=function(e){t.isDown=!1},t.handleMouseMove=function(e){if(t.isDown){e.preventDefault();var n=3*(e.pageX-t.slider.current.offsetLeft-t.startX);t.slider.current.scrollLeft=t.scrollLeft-n}},t.handleMouseLeave=function(e){t.isDown=!1},t}return Object(c.a)(t,e),t.prototype.render=function(){return a.a.createElement(b.a,{style:{flexWrap:"unset",overflowX:"auto",justifyContent:"flex-start"},ref:this.slider,onMouseDown:this.handleMouseDown,onMouseLeave:this.handleMouseLeave,onMouseMove:this.handleMouseMove,onMouseUp:this.handleMouseUp},this.props.children)},t}(r.Component),w=n("JI6e"),y=function(e){var t=e.date,n=e.timeslotLength,i=e.userSelectedSlots,o=(e.slotsWithOpening,e.selectTimeslot),s=e.unselectTimeslot,l=e.startHour,c=e.endHour,u=Object(r.useState)(!1),f=u[0],d=u[1],m=4*(c-l),p=Array.from(Array(m),(function(e,t){return 15*t})),v=n/15,b=function(e){var n=l+Math.floor(e/60),r=e%60;return new Date(t.getFullYear(),t.getMonth(),t.getDate(),n,r)},g=function(e){var t=e.getHours()%12;return 0===t&&(t=12),(t=t.toString().padStart(2,"0"))+":"+e.getMinutes().toString().padStart(2,"0")+" "+(e.getHours()>=12?"PM":"AM")},y=function(e,r){if(i.hasOwnProperty(e)){var a=i[e][0];return s(new Date(t.getFullYear(),t.getMonth(),t.getDate(),l+Math.floor(a/60),a%60))}if(function(e,t){if(t+v>p.length)return!1;for(var r=e+n,a=e;a<r;a+=15)if(i.hasOwnProperty(a))return!1;return!0}(e,r)){var c=e;return o(new Date(t.getFullYear(),t.getMonth(),t.getDate(),l+Math.floor(c/60),c%60))}d(!0)};return a.a.createElement(w.a,{style:{width:300,flex:"none"}},a.a.createElement("div",{style:{position:"fixed"}},a.a.createElement(h.a,{onClose:function(){return d(!1)},show:f,delay:3e3,autohide:!0},a.a.createElement(h.a.Body,null,a.a.createElement("strong",{className:"mr-auto",style:{color:"red"}},"Invalid option/timeslot conflict!")))),a.a.createElement("strong",null,t.toDateString()),p.map((function(e,t){var n=function(e,t){var n=t.hasOwnProperty(e);return{isSelected:n,isTop:n&&e===t[e][0],isMiddle:n&&!t[e].includes(e),isBottom:n&&e===t[e][1]}},r=function(e){var t=n(e,i),r=t.isTop,a=t.isMiddle,o=t.isBottom;return Object.assign({},{padding:10,cursor:"pointer",display:"flex",justifyContent:"space-between"},{borderLeft:"1px solid black",borderRight:"1px solid black",borderTop:o||a?"none":"1px solid black",borderBottom:r||a?"none":"1px solid black",background:i.hasOwnProperty(e)?"green":"white"})},o=n(e,i),s=o.isSelected,l=o.isTop,c=o.isMiddle,u=o.isBottom,f=function(n){var i=n.children;return a.a.createElement("div",{style:Object.assign({},r(e)),onClick:function(){return y(e,t)}},i)};if(s){if(l)return a.a.createElement(f,{key:e},a.a.createElement("span",null,g(b(e))));if(c)return a.a.createElement(f,{key:e},"-");if(u)return a.a.createElement(f,{key:e},a.a.createElement("span",null,g(b(e+15))))}return a.a.createElement("div",{style:Object.assign({},r(e)),key:e,onClick:function(){return y(e,t)}},a.a.createElement("span",null,g(b(e))),a.a.createElement("span",null,"-"),a.a.createElement("span",null,g(b(e+15))))})))},O=function(e){function t(){for(var t,n=arguments.length,r=new Array(n),a=0;a<n;a++)r[a]=arguments[a];return(t=e.call.apply(e,[this].concat(r))||this)._initFirebase=!1,t.state={settings:null,loading:!0,error:null,showToast:!1,selectedTimeslots:{},firstDataLoad:!0,runningTransaction:!1},t.unsub=null,t.loadSettings=Object(l.a)((function*(){t._initFirebase=!0;var e=yield t.props.firebase.generalSettings().get();if(e.exists){var n=e.data(),r={};n.timeslotDays=n.timeslotDays.map((function(e){var t=e.toDate();return r[t.toDateString()]=[],t})),t.setState({settings:n,selectedTimeslots:r},(function(){t.unsub=t.props.firebase.timeslots().onSnapshot((function(e){var n=t.state.selectedTimeslots;e.docs.map((function(e){return Object.assign({},e.data(),{time:e.data().time.toDate(),id:e.id})})).forEach((function(e){var t=e.time.toDateString();if(n.hasOwnProperty(t)){var r=n[t].findIndex((function(t){return t.id===e.id}));r>-1?n[t][r]=e:n[t].push(e)}else n[t]=[e]})),t.setState({selectedTimeslots:n,loading:!1,firstDataLoad:!1})}),console.error)}))}else t.setState({error:"Failed to load timeslots!"})})),t.saveTimeslots=Object(l.a)((function*(){var e=t.props.firebase,n=t.context,r=t.state,a=r.selectedTimeslots,i=r.settings;t.setState({selectedTimeslots:i.timeslotDays.reduce((function(e,t){return e[t.toDateString()]=[],e}),{}),runningTransaction:!0});var o=yield e.timeslots().get().then((function(e){return e.docs.map((function(e){return Object.assign({},e.data(),{time:e.data().time.toDate(),id:e.id})}))})),s=Object.values(a).flat().filter((function(e){return e.interviewers.hasOwnProperty(n.uid)})),c={};s.forEach((function(e,t){return c[e.time]=t}));var u=function(){var e=Object(l.a)((function*(e,t){for(var n=0;n<e.length;n++)yield t(e[n],n,e)}));return function(t,n){return e.apply(this,arguments)}}();try{yield e.firestoreRoot.runTransaction(function(){var t=Object(l.a)((function*(t){u(o.filter((function(e){return e.interviewers.hasOwnProperty(n.uid)})),function(){var r=Object(l.a)((function*(r,a){if(!c.hasOwnProperty(r.time)){var i=o[a],s=i.id;delete i.id,delete i.interviewers[n.uid],0!==Object.keys(i.interviewers).length||i.hasOwnProperty("applicant")?t.update(e.timeslot(s),i):t.delete(e.timeslot(s))}}));return function(e,t){return r.apply(this,arguments)}}()),yield u(s,function(){var r=Object(l.a)((function*(r){var a=o.filter((function(e){return e.time.getTime()===r.time.getTime()}));if(a.every((function(e){return!e.interviewers.hasOwnProperty(n.uid)}))){var i=!1;if(yield u(a,function(){var r=Object(l.a)((function*(r){if(!i){var a=yield t.get(e.timeslot(r.id)),o=Object.assign({},a.data());Object.keys(o.interviewers).length<2&&(o.interviewers[n.uid]=n.name,t.update(e.timeslot(r.id),o),i=!0)}}));return function(e){return r.apply(this,arguments)}}()),!i){({})[n.uid]=n.name;var s=e.timeslots().doc();t.set(s,r)}}}));return function(e){return r.apply(this,arguments)}}())}));return function(e){return t.apply(this,arguments)}}())}catch(f){t.setState({selectedTimeslots:a}),console.error("Transaction failure!",f),d()("Uh oh!","Something went wrong with saving your selections! Please refresh the page and try again!","error")}t.setState({showToast:!0,runningTransaction:!1}),window.scrollTo(0,document.body.scrollHeight)})),t.selectTimeslot=function(e){var n=e.toDateString(),r=t.state,a=r.selectedTimeslots,i=r.settings.timeslotLength,o=t.context,s=!1;if(a[n].filter((function(e){return!e.interviewers.hasOwnProperty(o.uid)})).forEach((function(t){t.time.getTime()===e.getTime()&&Object.keys(t.interviewers).length<2&&!s&&(t.interviewers[o.uid]=o.name,s=!0)})),!s){var l={};l[o.uid]=o.name,a[n].push({time:e,interviewers:l,timeslotLength:i})}t.setState({selectedTimeslots:a})},t.unselectTimeslot=function(e){var n=e.toDateString(),r=t.state.selectedTimeslots,a=t.context;r[n]=r[n].map((function(t){return t.interviewers.hasOwnProperty(a.uid)&&t.time.getTime()===e.getTime()&&delete t.interviewers[a.uid],t})),r[n]=r[n].filter((function(e){return Object.keys(e.interviewers).length>0||e.hasOwnProperty("applicant")})),t.setState({selectedTimeslots:r})},t.timeslotsToSlots=function(e){var n=t.state.settings.timeslotStart,r={};return e.forEach((function(e){for(var a=60*(e.time.getHours()-n)+e.time.getMinutes(),i=a+t.state.settings.timeslotLength-15,o=a;o<=i;o+=15)r[o]=[a,i]})),r},t}Object(c.a)(t,e);var n=t.prototype;return n.componentDidMount=function(){this.props.firebase&&!this._initFirebase&&this.loadSettings()},n.componentDidUpdate=function(e){this.props.firebase&&!this._initFirebase&&this.loadSettings()},n.componentWillUnmount=function(){"function"==typeof this.unsub&&this.unsub()},n.render=function(){var e=this,t=this.state,n=t.loading,r=t.runningTransaction,i=t.error,o=t.selectedTimeslots,s=t.showToast;if(n||r)return a.a.createElement(p.a,null);if(i)return a.a.createElement(v.c,{flexdirection:"column"},a.a.createElement("h1",null,i));var l=this.state.settings,c=l.timeslotsOpen,u=l.timeslotsOpenForApplicants,f=l.timeslotLength,d=l.timeslotDays,b=l.timeslotStart,w=l.timeslotEnd,O=this.context;return c?O.roles.applicant&&!u?a.a.createElement(v.c,{flexdirection:"column"},a.a.createElement("h1",null,"Timeslot selection isn't open yet!")):a.a.createElement(v.c,{flexdirection:"column"},a.a.createElement("h1",null,"Interviewer Timeslot Selection"),a.a.createElement(g,null,d.map((function(t,n){var r=o[t.toDateString()],i=r?e.timeslotsToSlots(r.filter((function(e){return e.interviewers.hasOwnProperty(O.uid)}))):{},s=r?e.timeslotsToSlots(r.filter((function(e){return!e.interviewers.hasOwnProperty(O.uid)&&Object.keys(e.interviewers).length<2}))):{};return a.a.createElement(y,{key:n,date:t,timeslotLength:f,userSelectedSlots:i,slotsWithOpening:s,selectTimeslot:e.selectTimeslot,unselectTimeslot:e.unselectTimeslot,startHour:b,endHour:w})}))),a.a.createElement("div",{style:{display:"flex",alignItems:"center"}},a.a.createElement(m.a,{style:{width:"fit-content",marginTop:20,marginBottom:20},onClick:this.saveTimeslots},"Save Selections"),a.a.createElement(h.a,{onClose:function(){return e.setState({showToast:!1})},show:s,delay:3e3,autohide:!0,style:{width:"fit-content",height:"fit-content",marginLeft:25}},a.a.createElement(h.a.Header,null,a.a.createElement("strong",{className:"mr-auto"},"Selections Saved!"))))):a.a.createElement(v.c,{flexdirection:"column"},a.a.createElement("h1",null,"Timeslot selection is closed!"))},t}(r.Component);O.contextType=o.AuthUserContext;var E=Object(u.a)(Object(o.withAuthorization)(i.f),o.withFirebase)(O),j=Object(u.a)(Object(o.withAuthorization)(i.b),o.withFirebase)((function(e){e.firebase;return a.a.createElement(v.c,{flexdirection:"column"},a.a.createElement("h1",null,"Applicant Timeslot Selection"))})),T=function(e){var t=e.location,n=Object(r.useContext)(o.AuthUserContext);return Object(i.f)(n)?a.a.createElement(E,{location:t}):a.a.createElement(j,{location:t})};t.default=function(){return a.a.createElement(s.a,null,a.a.createElement(T,null))}},XQC9:function(e,t,n){"use strict";var r=n("wx14"),a=n("zLVn"),i=n("q1tI"),o=n.n(i),s=n("TSYQ"),l=n.n(s),c=o.a.forwardRef((function(e,t){var n=e.label,i=e.onClick,s=e.className,c=Object(a.a)(e,["label","onClick","className"]);return o.a.createElement("button",Object(r.a)({ref:t,type:"button",className:l()("close",s),onClick:i},c),o.a.createElement("span",{"aria-hidden":"true"},"×"),o.a.createElement("span",{className:"sr-only"},n))}));c.displayName="CloseButton",c.defaultProps={label:"Close"},t.a=c},XcHJ:function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));var r=n("q1tI");function a(){var e=Object(r.useRef)(!0),t=Object(r.useRef)((function(){return e.current}));return Object(r.useEffect)((function(){return function(){e.current=!1}}),[]),t.current}},i52p:function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));var r=n("q1tI");function a(e){var t,n,a=(t=e,(n=Object(r.useRef)(t)).current=t,n);Object(r.useEffect)((function(){return function(){return a.current()}}),[])}},or9q:function(e,t,n){"use strict";var r=n("6LWA"),a=n("UMSQ"),i=n("A2ZE"),o=function(e,t,n,s,l,c,u,f){for(var d,m=l,h=0,p=!!u&&i(u,f,3);h<s;){if(h in n){if(d=p?p(n[h],h,t):n[h],c>0&&r(d))m=o(e,t,d,a(d.length),m,c-1)-1;else{if(m>=9007199254740991)throw TypeError("Exceed the acceptable array length");e[m]=d}m++}h++}return m};e.exports=o}}]);
//# sourceMappingURL=component---src-pages-timeslots-js-18f8d0d6dc0f5e3482b5.js.map